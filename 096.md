volodya

high

# protocol will constantly lose funds on partially openining a position

## Summary
protocol will constantly lose funds on partially opening a position
## Vulnerability Detail
Whenever partyB calls `openPosition` there is basically one more position in the system for partyA. And there is the possibility to cancel both of them or other ways like expiring both and so on, so userA will receive 2 trading fees instead of 1.

```solidity
    function openPosition(
        uint256 quoteId,
        uint256 filledAmount,
        uint256 openedPrice,
        PairUpnlAndPriceSig memory upnlSig
    ) internal returns (uint256 currentId) {
        QuoteStorage.Layout storage quoteLayout = QuoteStorage.layout();
        AccountStorage.Layout storage accountLayout = AccountStorage.layout();
...
    }

```
[facets/PartyB/PartyBFacetImpl.sol#L113](https://github.com/sherlock-audit/2023-06-symmetrical/blob/main/symmio-core/contracts/facets/PartyB/PartyBFacetImpl.sol#L113)
## Impact
User can create 1 position split it multiple times and cancel all thus stealing funds from protocol
## Code Snippet

## Tool used

Manual Review

## Recommendation
Seem like charging trading fee on openPosition for partyA is an option or rework how trading fee works completely 